function showScrollUpCommand(){$(window).scrollTop()>50?($("header").addClass("compressed"),$("a.scroll-up").fadeIn()):($("header").removeClass("compressed"),$("a.scroll-up").fadeOut())}function processActionHash(e,r){document.location.hash=e;var a=e.split("/");$("header .navegacion").find("a.activo").removeClass("activo"),$("header .navegacion").find("a[href=#seguros]").addClass("activo");var o=null,t=null,n=null;if(r&&r.length){if(o=[],t={},n={},"asegurar"==r.attr("id")){if(!r.find("input:checked").length)return r.find(".required-message .required-fields-error").remove(),r.find(".required-message").append('<div class="required-fields-error">Debes seleccionar un tipo de cobertura para continuar.</div>'),$("html, body").animate({scrollTop:$("#_seguro").offset().top-50},500),void(document.location.hash="/"+a[1]+"/"+a[2]+"/asegurar");r.find("input:checked").each(function(){o.push({id:$(this).val(),name:$(this).next().text()})})}if("cotizar"==r.attr("id")){var s=checkFieldsPass(r);if(s.error)return r.find(".required-message .required-fields-error").remove(),r.find(".required-message").append('<div class="required-fields-error">'+s.errors.join("")+"</div>"),$("html, body").animate({scrollTop:$("#_seguro").offset().top-50},500),void(document.location.hash="/"+a[1]+"/"+a[2]+"/cotizar")}"contratar"==r.attr("id")}var i=a[1]?a[1]:null,c=a[2]?a[2]:null,l=a[3]?a[3]:null,d=localStorage.getItem(i+"::"+c)?JSON.parse(localStorage.getItem(i+"::"+c)):{modelo:i,categoria:c,seguros:[],cotizacion:{},usuario:{}};switch(d.seguros=o?o:d.seguros,d.cotizacion=t?t:d.cotizacion,d.usuario=n?n:d.usuario,localStorage.setItem(i+"::"+c,JSON.stringify(d)),l){case"asegurar":case"cotizar":case"contratar":$("#_"+i).append('<div class="loading"><i class="fa fa-circle-o-notch fa-spin fa-2x"></i><br><span>Cargando <h3 class="titulo-seguro"><span>'+i+"</span><strong>"+c.replace("seguro","")+'</strong></h3></span><br><span><a href="#/'+i+"/"+c+'/cancelar">Cancelar</a></span></div>'),$("#_"+i).find(".loading").fadeIn(),$("html, body").animate({scrollTop:$("#_"+i).offset().top-50},500);var u=getFormAction(l,d);u.done(function(e,r){"success"==r&&($("#_"+i).find(".loading").fadeOut(function(){$(this).remove()}),$("#_"+i).find(".categorias").slideUp(),$("#_"+i).find(".formularios").html(e),$("#_"+i).find(".formularios").slideDown())});break;case"cancelar":case"terminar":document.location.hash="#seguro",$("#_"+i).find(".loading").remove(),u&&u.abort(),$("#_"+i).find(".categorias").slideDown(),$("#_"+i).find(".formularios").slideUp()}}function checkFieldsPass(e){var r=e.find("input, select, textarea"),a=!0,o={ok:!0,error:!1,errors:[]};return r.each(function(){var e=$(this);e.data("customrequired")&&""==$.trim(e.val())&&(a=!1,o.ok=!1,o.error=!0,o.errors.length||(o.errors.push("Hay campos con errores:"),o.errors.push("<ul>")),o.errors.push('<li>El campo <strong>"'+e.data("realname")+'"</strong> es requerido</li>')),e.data("customtype")&&(o=checkType(e.data("realname"),e.data("customtype"),e.val(),o)),(e.data("customcheck")||"none"!=e.data("customcheck"))&&(o=checkValidation(e.data("realname"),e.data("customcheck"),e.val(),o))}),o.errors.length&&o.errors.push("</ul>"),o}function getFormAction(e,r){return $.ajax({url:"/lib/api.php",method:"post",data:{accion:e,data:r}})}function checkType(e,r,a,o){switch(r){case"text":var t=/^[a-zA-Z\.]*$/;t.test(a)||(o.errors.length||(o.errors.push("Hay campos con errores:"),o.errors.push("<ul>")),o.errors.push('<li>El campo <strong>"'+e+'"</strong> debe ser sólo alfabético</li>'));break;case"numero":case"moneda-peso":case"moneda-dolar":var n=/^[0-9]*\,?[0,9]{0,2}$/;n.test(a)||(o.errors.length||(o.errors.push("Hay campos con errores:"),o.errors.push("<ul>")),o.errors.push('<li>El campo <strong>"'+e+'"</strong> debe ser sólo numérico y como máximo tener 2 decimales (ejemplo: 1000,00)</li>'))}return o}function checkValidation(e,r,a,o){switch(r){case"ci":verifyDNI(a)||(o.errors.length||(o.errors.push("Hay campos con errores:"),o.errors.push("<ul>")),o.errors.push('<li>El campo <strong>"'+e+'"</strong> no es una Cédula de Identidad válida, por favor verifica la información.</li>'));break;case"numero":var t=/^[0-9]*\,?[0,9]{0,2}$/;t.test(a)||(o.errors.length||(o.errors.push("Hay campos con errores:"),o.errors.push("<ul>")),o.errors.push('<li>El campo <strong>"'+e+'"</strong> debe ser sólo numérico y como máximo tener 2 decimales (ejemplo: 1000,00)</li>'))}return o}function verifyDNI(e){var r,a,o,t,n,s;r=e,a=r.toString(),o=a[a.length-1],t=[2,9,8,7,6,3,4],n=0;for(var i=0;i<a.length-1;i++)n+=a[i]*t[i];return s=10*Math.ceil(n/10),s-n==o}String.prototype.replaceAll=function(e,r){return this.toString().split(e).join(r)},$(document).on("ready",function(){function e(){window.carouselTimer=setTimeout(function(){var r=$("#slider-banner").jcarousel("visible"),a=r.index();a<r.parent().find("> li").length-1?$("#slider-banner").jcarousel("scroll",a+1,!0,function(){e()}):$("#slider-banner").jcarousel("scroll",0,!0,function(){e()})},3e3)}if(showScrollUpCommand(),$("#slider-banner").jcarousel({transitions:{transforms3d:!0,easing:"ease"}}),e(),""!=document.location.hash)try{$("header .navegacion").find("a[href="+document.location.hash+"]"),$("header .navegacion").find("a.activo").removeClass("activo"),$("header .navegacion").find("a[href="+document.location.hash+"]").addClass("activo"),setTimeout(function(){$("html, body").scrollTop(0),$("html, body").animate({scrollTop:$("#_"+document.location.hash.replace("#","")).offset().top-("#home"!=document.location.hash?50:80)},500)},50)}catch(r){-1!=document.location.hash.indexOf("#/")&&processActionHash(document.location.hash)}$("body").on("click","a",function(e){e.preventDefault();var r=$(this);if("#"==r.attr("href"))return!1;try{$("#_"+r.attr("href").replace("#",""))}catch(e){return r.attr("target")?window.open(r.attr("href"),r.attr("target")):-1!=r.attr("href").indexOf("#/")?processActionHash(r.attr("href"),$("#"+r.data("objetformid"))):document.location.href=r.attr("href"),!1}return $("header .navegacion").find("a.activo").removeClass("activo"),$("header .navegacion").find("a[href="+r.attr("href")+"]").addClass("activo"),$("#_seguro").find(".categorias").slideDown(),$("#_seguro").find(".formularios").slideUp(),$("html, body").animate({scrollTop:$("#_"+r.attr("href").replace("#","")).offset().top-("#home"!=r.attr("href")?50:80)},500),document.location.hash=r.attr("href"),!1});var a=null;$("body").on("click","input[type=checkbox]",function(){var e=$(this).val(),r=parseInt(e),o=$(this).prop("checked"),t=$(this).parents("form"),n=t.find("input[type=checkbox][data-parent][value!="+r+"]"),s=t.parent().find(".tablas:visible"),i=t.parent().find("#tablas-seg"+r);s.slideUp(),o&&i.slideDown(),a=null,t.find("input[type=checkbox][value!="+e+"]:checked").prop({checked:!1,disabled:!1}),a=o?r:null,n.each(function(){$(this).data("parent")==r&&$(this).prop({checked:o,disabled:o})}),o||(a=null)})}),$(window).on("scroll",function(){showScrollUpCommand()});